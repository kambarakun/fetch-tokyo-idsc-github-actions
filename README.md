# æ±äº¬éƒ½æ„ŸæŸ“ç—‡ç™ºç”Ÿå‹•å‘ãƒ‡ãƒ¼ã‚¿è‡ªå‹•åé›†ã‚·ã‚¹ãƒ†ãƒ 

æ±äº¬éƒ½æ„ŸæŸ“ç—‡ç™ºç”Ÿå‹•å‘æƒ…å ±ã‚·ã‚¹ãƒ†ãƒ ã‹ã‚‰å®šæœŸçš„ã«ãƒ‡ãƒ¼ã‚¿ã‚’è‡ªå‹•å–å¾—ã™ã‚‹ã‚·ã‚¹ãƒ†ãƒ ã§ã™ã€‚

## ğŸ“‹ æ¦‚è¦

- æ±äº¬éƒ½ã®æ„ŸæŸ“ç—‡ç™ºç”Ÿå‹•å‘ãƒ‡ãƒ¼ã‚¿ã‚’é€±æ¬¡ã§è‡ªå‹•åé›†
- GitHub Actionsã«ã‚ˆã‚‹è‡ªå‹•å®Ÿè¡Œï¼ˆæ¯é€±æœˆæ›œ19:00 JSTï¼‰
- 9ç¨®é¡ã®ãƒ‡ãƒ¼ã‚¿ã‚¿ã‚¤ãƒ—ã«å¯¾å¿œ
- ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã¨ãƒªãƒˆãƒ©ã‚¤æ©Ÿèƒ½
- ãƒ‡ãƒ¼ã‚¿æ•´åˆæ€§æ¤œè¨¼ï¼ˆSHA256ãƒãƒƒã‚·ãƒ¥ï¼‰

## âš™ï¸ å¿…è¦ãªè¨­å®š

### GitHub Actionsæ¨©é™è¨­å®šï¼ˆé‡è¦ï¼‰

ã“ã®ã‚·ã‚¹ãƒ†ãƒ ãŒPull Requestã‚’è‡ªå‹•ä½œæˆã™ã‚‹ãŸã‚ã«ã¯ã€ãƒªãƒã‚¸ãƒˆãƒªç®¡ç†è€…ã«ã‚ˆã‚‹ä»¥ä¸‹ã®è¨­å®šãŒ**å¿…é ˆ**ã§ã™ï¼š

1. **Settings â†’ Actions â†’ General â†’ Workflow permissions** ã¸ç§»å‹•
2. **ã€ŒRead and write permissionsã€** ã‚’é¸æŠ
3. **ã€Œâ˜‘ Allow GitHub Actions to create and approve pull requestsã€** ã‚’ãƒã‚§ãƒƒã‚¯
4. **ã€ŒSaveã€** ã‚’ã‚¯ãƒªãƒƒã‚¯

> âš ï¸ ã“ã®è¨­å®šã‚’è¡Œã‚ãªã„ã¨ã€ãƒ‡ãƒ¼ã‚¿å–å¾—ã¯æˆåŠŸã—ã¦ã‚‚PRä½œæˆã§ã‚¨ãƒ©ãƒ¼ã«ãªã‚Šã¾ã™

## ğŸš€ ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

### uvã‚’ä½¿ç”¨ï¼ˆå®Œå…¨æ¨å¥¨ï¼‰

```bash
# ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ã‚¯ãƒ­ãƒ¼ãƒ³
git clone https://github.com/kambarakun/fetch-tokyo-idsc-github-actions.git
cd fetch-tokyo-idsc-github-actions

# ä¾å­˜é–¢ä¿‚ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
uv sync

# é–‹ç™ºç”¨ä¾å­˜é–¢ä¿‚ã‚‚å«ã‚ã‚‹å ´åˆ
uv sync --all-extras

# pre-commitãƒ•ãƒƒã‚¯ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ï¼ˆé–‹ç™ºè€…å‘ã‘ï¼‰
uv run pre-commit install
```

### pre-commitã«ã‚ˆã‚‹ã‚³ãƒ¼ãƒ‰å“è³ªç®¡ç†

é–‹ç™ºæ™‚ã¯pre-commitã‚’ä½¿ç”¨ã—ã¦ã‚³ãƒ¼ãƒ‰å“è³ªã‚’ç¶­æŒã—ã¾ã™ï¼š

```bash
# åˆå›è¨­å®šï¼ˆå¿…é ˆï¼‰
uv run pre-commit install

# ã™ã¹ã¦ã®ãƒ•ã‚¡ã‚¤ãƒ«ã«å¯¾ã—ã¦æ‰‹å‹•å®Ÿè¡Œ
uv run pre-commit run --all-files

# ç‰¹å®šã®ãƒ•ãƒƒã‚¯ã®ã¿å®Ÿè¡Œ
uv run pre-commit run black --all-files
uv run pre-commit run isort --all-files

# ãƒ•ãƒƒã‚¯ã®è‡ªå‹•æ›´æ–°
uv run pre-commit autoupdate
```

pre-commitã«ã‚ˆã‚‹è‡ªå‹•ãƒã‚§ãƒƒã‚¯é …ç›®ï¼š

- âœ… Pythonã‚³ãƒ¼ãƒ‰ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆï¼ˆblack, isortï¼‰
- âœ… ã‚³ãƒ¼ãƒ‰å“è³ªãƒã‚§ãƒƒã‚¯ï¼ˆflake8, mypyï¼‰
- âœ… ãƒ•ã‚¡ã‚¤ãƒ«æœ«å°¾æ”¹è¡Œãƒ»ç©ºç™½å‰Šé™¤
- âœ… YAML/JSONæ§‹æ–‡ãƒã‚§ãƒƒã‚¯
- âœ… ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆæ¤œå‡º
- âœ… å¤§ããªãƒ•ã‚¡ã‚¤ãƒ«ã®è¿½åŠ é˜²æ­¢

## ğŸ“Š ä½¿ç”¨æ–¹æ³•

### ãƒ­ãƒ¼ã‚«ãƒ«å®Ÿè¡Œ

```bash
# æœ€æ–°ãƒ‡ãƒ¼ã‚¿ã®ã¿å–å¾—
uv run python scripts/fetch_data.py

# æŒ‡å®šæœŸé–“ã®ãƒ‡ãƒ¼ã‚¿å–å¾—
uv run python scripts/fetch_data.py --start-year 2000 --end-year 2025

# ãƒ‰ãƒ©ã‚¤ãƒ©ãƒ³ï¼ˆãƒ†ã‚¹ãƒˆå®Ÿè¡Œï¼‰
uv run python scripts/fetch_data.py --dry-run

# æ¬ ç•ªãƒã‚§ãƒƒã‚¯
uv run python scripts/check_missing.py data/raw
```

### GitHub Actions

è‡ªå‹•å®Ÿè¡Œï¼š

- æ¯é€±æœˆæ›œæ—¥ 19:00 JST ã«è‡ªå‹•å®Ÿè¡Œ

æ‰‹å‹•å®Ÿè¡Œï¼š

1. GitHub ãƒªãƒã‚¸ãƒˆãƒªã® Actions ã‚¿ãƒ–ã‚’é–‹ã
2. "Fetch Tokyo Epidemic Data" ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã‚’é¸æŠ
3. "Run workflow" ã‚’ã‚¯ãƒªãƒƒã‚¯
4. å¿…è¦ã«å¿œã˜ã¦ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’è¨­å®šã—ã¦å®Ÿè¡Œ

## ğŸ“ ãƒ‡ãƒ¼ã‚¿æ§‹é€ 

åé›†ã•ã‚ŒãŸãƒ‡ãƒ¼ã‚¿ã¯ä»¥ä¸‹ã®æ§‹é€ ã§ä¿å­˜ã•ã‚Œã¾ã™ï¼š

```
data/
â”œâ”€â”€ raw/                    # ç”Ÿãƒ‡ãƒ¼ã‚¿ï¼ˆShift_JISï¼‰
â”‚   â””â”€â”€ 2025/
â”‚       â””â”€â”€ 01/
â”‚           â””â”€â”€ week_01/
â”‚               â”œâ”€â”€ sentinel_weekly_gender_2025_1_*.csv
â”‚               â””â”€â”€ metadata.json
â”œâ”€â”€ processed/             # å‡¦ç†æ¸ˆã¿ãƒ‡ãƒ¼ã‚¿
â””â”€â”€ logs/                  # ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«
```

## ğŸ› ï¸ è¨­å®š

`config/config.yml` ã§è©³ç´°ãªè¨­å®šãŒå¯èƒ½ï¼š

- ãƒ‡ãƒ¼ã‚¿åé›†é–“éš”
- å¯¾è±¡ãƒ‡ãƒ¼ã‚¿ã‚¿ã‚¤ãƒ—
- ã‚¨ãƒ©ãƒ¼é€šçŸ¥è¨­å®š
- ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸è¨­å®š

## ğŸ§ª ãƒ†ã‚¹ãƒˆ

```bash
# ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
uv run pytest

# ã‚«ãƒãƒ¬ãƒƒã‚¸ãƒ¬ãƒãƒ¼ãƒˆä»˜ã
uv run pytest --cov=src --cov-report=html
```

## ğŸ“ ãƒ©ã‚¤ã‚»ãƒ³ã‚¹

MIT

## ğŸ”— é–¢é€£æƒ…å ±

- ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹: [æ±äº¬éƒ½æ„ŸæŸ“ç—‡ç™ºç”Ÿå‹•å‘æƒ…å ±](https://survey.tmiph.metro.tokyo.lg.jp/epidinfo/epimenu.do)
- è¨­è¨ˆæ›¸: `.kiro/specs/tokyo-epidemic-data-automation/`
